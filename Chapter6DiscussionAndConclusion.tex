\chapter{Discussion and Conclusion} \label{sec:discussion_and_conclusion}
    \vspace*{\fill}
    \setlength{\epigraphwidth}{0.4\linewidth}
    \renewcommand{\epigraphflush}{flushright}
    \renewcommand{\epigraphsize}{\footnotesize}
    \epigraph{A lack of oxygen\newline
              From my life support, my iron lung}%
              {\textit{My Iron Lung}\\ \textsc{Radiohead}}
    
    \newpage

    \section{Discussion and Conclusion} \label{sec:discussion_and_conclusion_discussion_and_conclusion}
        This chapter will recap the conclusions from previous chapters before moving onto discussing potential future work. Respiratory motion is still a significant problem in \gls{PET} potentially leading clinically to the misdiagnosis of many illnesses. This thesis has strived to present a method through which this respiratory motion can be somewhat mitigated. The methods developed were always developed with the intention to be minimally invasive to current clinical practise. For instance, not requiring anything other than what is already available and not increasing the time to produce results significantly. This has been the case while also attempting to make the methods as universally applicable as possible. Although it has not been thoroughly evaluated together, with both the motion correction presented in~\Fref{sec:initial_motion_correction_using_basic_reconstruction_and_gating_methods_with_less_challenging_data} and~\Fref{sec:subsequent_motion_correction_using_advanced_reconstruction_and_gating_methods_with_more_challenging_data} and the dynamic \gls{SS} extraction method presented in~\Fref{sec:data_driven_surrogate_signal_extraction_for_dynamic_pet} it could now be the case that this may be true for dynamic \gls{PET}.

        \begin{itemize}
            \item \Fref{sec:impact_of_tof_on_respiratory_motion_model_estimation_using_pre_gated_no_intra_cycle_motion_nac_pet} evaluated the impact of the introduction of \gls{TOF} \gls{PET} on the quality of motion correction possible with \gls{NAC} \gls{PET}. This work was performed in order to assess if it was feasible to further develop a motion correction method which was unbiased by a static \gls{CT} \gls{Mu-Map}. If a static \gls{CT} \gls{Mu-Map} was used for \gls{AC} prior to motion correction then it is likely that the artefacts added would cause the motion correction to fail. However, if \gls{NAC} \gls{PET} was used it was also likely that there was not enough signal from the lungs and diaphragm for motion correction to be possible. It was previously observed that \gls{TOF} in the absence of a \gls{Mu-Map} significantly improved the distribution of the signal. This work concluded that it was in fact possible to perform an adequate motion correction using \gls{NAC} \gls{TOF} \gls{PET}. However, the simulations used during this work were extremely simple, they did not even include intra-gate respiratory motion. The simulations also did not include randoms and scatter and also used a high \gls{TOF} resolution. It would be later shown by other work that \gls{NAC} \gls{TOF} \gls{OSEM} was insufficient on its own to motion correct more realistic data.

            \item \Fref{sec:pet_ct_respiratory_motion_correction_with_a_single_attenuation_map_using_nac_derived_deformation_fields} attempted to show a motion correction method which could begin to address the problem of their being one static \gls{Mu-Map}. For accurate motion correction each bin used for motion correction should be individually \gls{AC} using a \gls{Mu-Map} at the same respiratory position. Furthermore, this section evaluated if it is necessary to fit a further \gls{MM} on the bins which had been \gls{AC} by the static \gls{Mu-Map} which has been deformed to their position. It was concluded that the method presented was satisfactory to perform a motion correction with a static \gls{Mu-Map}, without introducing misalignment artefacts. Also, it was found that a \gls{MM} fit on the \gls{AC} data did not provide a better motion correction than the already fit \gls{MM}. This is positive because it means that additional computation to fit the second \gls{MM} was unnecessary. A significant downside of the work presented here is that the static \gls{Mu-Map} was at the mean respiratory position, which is the easiest position for this method to work.

            \item \Fref{sec:comparison_of_motion_correction_methods_incorporating_motion_modelling_for_pet_ct_using_a_single_breath_hold_attenuation_map} introduced simulations which were much more realistic than shown in previous sections. The \glspl{SS} used to drive \gls{XCAT} allowed hysteresis and breath to breath variation. The lesion is a much more realistic size, motion correction would not be needed to identify the lesion used in previous sections. For the first time a background term has been added. Other than this the work sought to evaluate the benefit of including a \gls{MM} as part of a motion correction workflow and using a pair- or group-wise registration scheme. For both the pair- and group-wise registration scheme it was found that including a \gls{MM} was beneficial. The pair-wise registration did not work without a \gls{MM}. While the group-wise registration did seem to work better than the pair-wise registration method it was still found that the inclusion of a \gls{MM} provided a result where the lesion was more homogeneous. Group-wise registration would continue to be used for all future registrations.

            \item \Fref{sec:pet_ct_motion_correction_exploiting_motion_models_fit_on_coarsely_gated_data_applied_to_finely_gated_data} showed a further benefit of motion modelling, it is possible to fit the motion correction on data which has been binned at a different rate to the data which it will be applied on. This is possible as long as the space of the \gls{SS} remains consistent. This was the first piece of work which made use of significantly more complex simulations (again) and also \gls{MLACF}, the latter of which proved to be invaluable to the quality of the motion correction results. With the more complex simulations, even with \gls{MLACF}, the same gating scheme as was used in~\Fref{sec:comparison_of_motion_correction_methods_incorporating_motion_modelling_for_pet_ct_using_a_single_breath_hold_attenuation_map} now resulted in a complete failure of the motion correction. However, with the new coarse gating scheme (applied to data binned in the same way) the results were significantly improved. With the coarse gating scheme motion correction was successful. However, from a visual analysis it can be seen here that the \gls{MM} which was fit on noisy reconstructions performed better than the \gls{MM} fit on noiseless data. This is most likely because of the method used to optimise the hyperparameters for this method overfitting the hyperparameters for the noisy case. In the noisy case it is likely that noise is being registered together to provide a peak where the lesion is expected to be. Because the hyperparameters are overfit the method performs worse in the noiseless case, even though it is a more simple problem.

            \item \Fref{sec:evaluation_of_pet_ct_motion_correction_incorporating_motion_models_using_mlacf_and_complex_gating_schemes} presented work to prepare the method for patient data. This included significant improvements, again, to the simulations. For instance, the simulation was swapped from a \gls{2D} to a \gls{3D} acquisition, this may seem trivial but it caused \gls{MLACF} to perform differently. Furthermore, the \gls{MLACF} algorithm was tweaked slightly to make it more robust. This was mainly achieved by initialising and constraining the \glspl{ACF} using the \gls{CT} \gls{Mu-Map}. Although this work intended to test the method with patient data this is still ongoing at time of writing. Furthermore, this method attempted to demonstrate the difference between gating schemes (`phase' and amplitude, \gls{2D} and \gls{1D} \gls{SS}) as well as the number of bins used and the reconstruction algorithm used (\gls{MLACF}, \gls{AC} \gls{OSEM}, and \gls{NAC} \gls{OSEM}). The conclusions reached here were that the most important factor with regards to gating was that a small number of bins are used for gating. \gls{MLACF} showed significant improvements over both variations of \gls{OSEM} when using the same gating scheme.

            \item \Fref{sec:data_driven_surrogate_signal_extraction_for_dynamic_pet}, as a change of pace, demonstrated work on \gls{DD} \gls{SS} extraction for dynamic \gls{PET}. Here, a multitude of methods were presented and evaluated against each other to extract a respiratory \gls{SS} from dynamic \gls{PET} (where the tracer kinetics at the beginning of the scan obscure the respiration). There methods were compared to a method from the literature. Three methods proved to have generally better and robust performance when compared to the literature. The first method proposed taking a \gls{PC} from a late time interval and applying it to the whole data set. The second and third methods used a frequency and \gls{NN} based scoring metric to combine \glspl{PC}. On the whole the \gls{NN} based method gave the best performance. However, the \gls{NN} used in this method is not publicly available and as such the other two methods are adequate. This work potentially opens all the previous motion correction work up to being applicable to dynamic \gls{PET}.
        \end{itemize}

        There are a number of potential future avenues for work, these include the following.

        \begin{itemize}
            \item The most obvious route for future work would be to complete the patient evaluation of the motion correction method, as proposed in~\Fref{sec:subsequent_motion_correction_using_advanced_reconstruction_and_gating_methods_with_more_challenging_data_discussion}. The steps needed to run the method with patient data have already been covered. However, one issue which could be further foreseen is that evaluation is significantly more difficult on patient data due to the lack of a ground truth. One method of evaluation would be to include clinicians in the process and ask their opinion, although more methods will be required than just this. \gls{PIQE} was used in~\Fref{sec:evaluation_of_pet_ct_motion_correction_incorporating_motion_models_using_mlacf_and_complex_gating_schemes_methods_evaluation} as it does not require a ground truth, although this was shown to be potentially unreliaable in~\Fref{sec:evaluation_of_pet_ct_motion_correction_incorporating_motion_models_using_mlacf_and_complex_gating_schemes_results}. Regardless, a paper will follow showing patient results.

            \item Secondly, because~\Fref{sec:data_driven_surrogate_signal_extraction_for_dynamic_pet} opens up the possibility for the motion correction methods to be applied to \gls{PET} this should probably be attempted. An issue with trying this is that the tracer in the aorta at early time intervals will probably prove difficult to register. This is where \glspl{MM} may come in handy again. If early time intervals are removed during the registration and \gls{MM} fitting steps then the \gls{SS} could be used to generate \glspl{DVF} for these time intervals from the \gls{MM}.

            \item \Fref{sec:a_bayesian_neural_network-based_method_for_the_extraction_of_a_metabolite_corrected_arterial_input_function_from_dynamic_pbr28_pet_appendix} presents a method, using \glspl{NN} to extract a \gls{TAC} from dynamic \gls{PET}. When trying to extract a \gls{TAC} it could be assumed that if the \gls{FOV} includes the thorax then one of the signals which the method would be trying to remove may be respiration. In a very simple way, \Fref{sec:data_driven_surrogate_signal_extraction_for_dynamic_pet} could be considered to be trying to remove the \gls{TAC} from the respiratory \gls{SS}. Therefore it would stand to reason if the two works were combined that it should be possible to invert the purpose of the \gls{NN} from~\Fref{sec:a_bayesian_neural_network-based_method_for_the_extraction_of_a_metabolite_corrected_arterial_input_function_from_dynamic_pbr28_pet_appendix} in order to design a \gls{NN} which can be used to extract respiratory \gls{SS} from dynamic \gls{PET}.

            \item \gls{DIP}, as seen in~\Fref{sec:pseudo_bayesian_dip_denoising_as_a_preprocessing_step_for_kinetic_modelling_in_dynamic_pet_appendix}, was presented in~\parencite{Ulyanov2020DeepPrior} as a \gls{NN} based method to solve general inverse problems. \gls{DIP} could potentially aid in a \gls{NN} based method to approximate a generalised framework unifying registration and \gls{MM} estimation, NiftyRegResp (now named \gls{SuPReMo}). If a \gls{NN} was designed which took as input an \gls{ND} \gls{SS} and output a \gls{DVF} then it could be conceived that it is possible to be trained in the same manner as \gls{DIP} to produce the \gls{NN} as a model which is similar to a \gls{MM}. If no activation functions were used then conceptually the \gls{NN} could be almost identical to the model in NiftyRegResp (\gls{SuPReMo}). However, if activation functions were added, the model would be non-linear, which is discussed as a potential benefit (or an avenue for overfitting) in~\Fref{sec:initial_motion_correction_using_basic_reconstruction_and_gating_methods_with_less_challenging_data_discussion} and~\Fref{sec:subsequent_motion_correction_using_advanced_reconstruction_and_gating_methods_with_more_challenging_data_discussion}. In order to implement this the most necessary step would be a resampler written in the \gls{NN} framework of choice. Parameterisation and regularisation (such as those in NiftyReg) could be added as either an additional architectural requirement or summed with the loss.

            \item Finally, there have been strides recently in the domain of \gls{DIP} applied to the reconstruction process. This would be where a \gls{DIP} \gls{NN} is used to reconstruct \gls{PET} data. However, it has not been seen recently a method to reconstruct \gls{4D} or dynamic \gls{PET} using \gls{DIP}. This would be a logical extension of the methods presented in~\Fref{sec:pseudo_bayesian_dip_denoising_as_a_preprocessing_step_for_kinetic_modelling_in_dynamic_pet_appendix}. The main limitation to implementing this is that the forward model would be required to be implemented in the \gls{NN} framework of choice.
        \end{itemize}
